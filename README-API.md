# ุฏููู ุชุดุบูู ูุธุงู APIs - Fener Travel

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅูุดุงุก ูุธุงู API ุดุงูู ูุฑุจุท ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ุจูุงุนุฏุฉ ุงูุจูุงูุงุช. ุงููุธุงู ูุชููู ูู:

### ๐๏ธ ูููู ุงููุธุงู

```
Frontend (React + Vite)  โโ  API Server (Express)  โโ  Database (Prisma + PostgreSQL/MySQL/SQLite)
```

### ๐ ูููู ุงููููุงุช

```
src/
โโโ server/                    # API Server
โ   โโโ index.ts              # ููุทุฉ ุจุฏุงูุฉ ุงูุฎุงุฏู
โ   โโโ routes/               # ูุณุงุฑุงุช API
โ       โโโ auth.ts           # ุงููุตุงุฏูุฉ
โ       โโโ shipments.ts      # ุงูุดุญูุงุช
โ       โโโ users.ts          # ุงููุณุชุฎุฏููู
โ       โโโ branches.ts       # ุงููุฑูุน
โ       โโโ countries.ts      # ุงูุจูุฏุงู
โ       โโโ status.ts         # ุญุงูุงุช ุงูุดุญูุฉ
โ       โโโ logs.ts           # ุงูุณุฌูุงุช
โโโ lib/
โ   โโโ api-client.ts         # ุนููู API ููู frontend
โ   โโโ api.ts               # ุฎุฏูุงุช API
โ   โโโ prisma.ts            # ุฅุนุฏุงุฏ Prisma
โ   โโโ auth.ts              # ูุธุงุฆู ุงููุตุงุฏูุฉ
โ   โโโ database.ts          # ุฎุฏูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช
โโโ contexts/
    โโโ AuthContext-new.tsx  # ุณูุงู ุงููุตุงุฏูุฉ ุงูุฌุฏูุฏ
    โโโ DataContext-new.tsx  # ุณูุงู ุงูุจูุงูุงุช ุงูุฌุฏูุฏ
```

## ๐ ุชุดุบูู ุงููุธุงู

### 1. ุฅุนุฏุงุฏ ูุชุบูุฑุงุช ุงูุจูุฆุฉ

ุงูุณุฎ ููู `.env.example` ุฅูู `.env` ูุนุฏู ุงูููู:

```env
# Database
DATABASE_URL="postgresql://username:password@localhost:5432/fenertravel?schema=public"

# JWT Secret
JWT_SECRET="your-super-secret-jwt-key-here-make-it-long-and-complex"

# App Configuration
NODE_ENV="development"
PORT=3000
API_PORT=5030

# Frontend Configuration
VITE_API_URL="http://localhost:5030/api"
```

### 2. ุชุซุจูุช ุงูููุชุจุงุช ุงูุฌุฏูุฏุฉ

```bash
yarn install
```

### 3. ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช

```bash
# ุฅูุดุงุก ูุชุทุจูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
yarn db:push

# ุชุนุจุฆุฉ ุงูุจูุงูุงุช ุงูุฃูููุฉ
yarn db:seed
```

### 4. ุชุดุบูู ุงููุธุงู ุงููุงูู

```bash
# ุชุดุบูู API Server ูุงููุงุฌูุฉ ุงูุฃูุงููุฉ ูุนุงู
yarn dev:full
```

ุฃู ููููู ุชุดุบููููุง ูููุตููู:

```bash
# ูู terminal ูููุตู - ุชุดุบูู API Server
yarn api:dev

# ูู terminal ุขุฎุฑ - ุชุดุบูู Frontend
yarn dev
```

### 5. ุงููุตูู ููุชุทุจูู

- **ุงููุงุฌูุฉ ุงูุฃูุงููุฉ**: http://localhost:3000
- **API Server**: http://localhost:5030
- **API Health Check**: http://localhost:5030/api/health

## ๐ ุงููุตุงุฏูุฉ

ูุณุชุฎุฏู ุงููุธุงู JWT tokens ูููุตุงุฏูุฉ:

### ุจูุงูุงุช ุงูุฏุฎูู ุงูุงูุชุฑุงุถูุฉ:

- **ุงููุฏูุฑ ุงูุนุงู**: `admin@fenertravel.com` / `123456`
- **ููุธู ูุฑุน ุงูุฑูุงุถ**: `ahmed@fenertravel.com` / `123456`
- **ููุธู ูุฑุน ุฌุฏุฉ**: `fatima@fenertravel.com` / `123456`
- **ููุธู ูุฑุน ุฏุจู**: `mohammed@fenertravel.com` / `123456`

### ุฏูุฑุฉ ุงููุตุงุฏูุฉ:

1. ุชุณุฌูู ุงูุฏุฎูู โ ุงูุญุตูู ุนูู JWT token
2. ุญูุธ Token ูู localStorage
3. ุฅุฑุณุงู Token ูุน ูู ุทูุจ API ูู Authorization header
4. ุงูุชุญูู ูู ุตุญุฉ Token ูู ูู ุทูุจ

## ๐ก API Endpoints

### Authentication `/api/auth`

```
POST   /login          # ุชุณุฌูู ุงูุฏุฎูู
GET    /me             # ุงูุญุตูู ุนูู ุงููุณุชุฎุฏู ุงูุญุงูู
POST   /logout         # ุชุณุฌูู ุงูุฎุฑูุฌ
```

### Shipments `/api/shipments`

```
GET    /               # ูุงุฆูุฉ ุงูุดุญูุงุช (ูุน pagination ูููุชุฑุฉ)
POST   /               # ุฅูุดุงุก ุดุญูุฉ ุฌุฏูุฏุฉ
GET    /:id            # ุชูุงุตูู ุดุญูุฉ
PUT    /:id            # ุชุญุฏูุซ ุดุญูุฉ
DELETE /:id            # ุญุฐู ุดุญูุฉ
PATCH  /:id/status     # ุชุญุฏูุซ ุญุงูุฉ ุงูุดุญูุฉ
GET    /track/:number  # ุชุชุจุน ุดุญูุฉ (ุนุงู - ุจุฏูู ูุตุงุฏูุฉ)
GET    /:id/history    # ุชุงุฑูุฎ ุงูุดุญูุฉ
GET    /:id/tracking   # ุฃุญุฏุงุซ ุงูุชุชุจุน
```

### Users `/api/users`

```
GET    /               # ูุงุฆูุฉ ุงููุณุชุฎุฏููู (ูููุฏุฑุงุก ููุท)
POST   /               # ุฅูุดุงุก ูุณุชุฎุฏู ุฌุฏูุฏ (ูููุฏุฑุงุก ููุท)
GET    /:id            # ุชูุงุตูู ูุณุชุฎุฏู
PUT    /:id            # ุชุญุฏูุซ ูุณุชุฎุฏู
DELETE /:id            # ุญุฐู ูุณุชุฎุฏู (ูููุฏุฑุงุก ููุท)
```

### Branches `/api/branches`

```
GET    /               # ูุงุฆูุฉ ุงููุฑูุน
POST   /               # ุฅูุดุงุก ูุฑุน ุฌุฏูุฏ (ูููุฏุฑุงุก ููุท)
GET    /:id            # ุชูุงุตูู ูุฑุน
PUT    /:id            # ุชุญุฏูุซ ูุฑุน (ูููุฏุฑุงุก ููุท)
DELETE /:id            # ุญุฐู ูุฑุน (ูููุฏุฑุงุก ููุท)
GET    /:id/stats      # ุฅุญุตุงุฆูุงุช ุงููุฑุน
```

### Countries `/api/countries`

```
GET    /               # ูุงุฆูุฉ ุงูุจูุฏุงู
POST   /               # ุฅูุดุงุก ุจูุฏ ุฌุฏูุฏ (ูููุฏุฑุงุก ููุท)
GET    /:id            # ุชูุงุตูู ุจูุฏ
PUT    /:id            # ุชุญุฏูุซ ุจูุฏ (ูููุฏุฑุงุก ููุท)
DELETE /:id            # ุญุฐู ุจูุฏ (ูููุฏุฑุงุก ููุท)
```

### Status `/api/status`

```
GET    /               # ูุงุฆูุฉ ุญุงูุงุช ุงูุดุญูุฉ
POST   /               # ุฅูุดุงุก ุญุงูุฉ ุฌุฏูุฏุฉ (ูููุฏุฑุงุก ููุท)
GET    /:id            # ุชูุงุตูู ุญุงูุฉ
PUT    /:id            # ุชุญุฏูุซ ุญุงูุฉ (ูููุฏุฑุงุก ููุท)
DELETE /:id            # ุญุฐู ุญุงูุฉ (ูููุฏุฑุงุก ููุท)
```

### Logs `/api/logs`

```
GET    /               # ูุงุฆูุฉ ุงูุณุฌูุงุช
GET    /:id            # ุชูุงุตูู ุณุฌู
GET    /stats/summary  # ุฅุญุตุงุฆูุงุช ุงูุณุฌูุงุช
DELETE /cleanup        # ุชูุธูู ุงูุณุฌูุงุช ุงููุฏููุฉ (ูููุฏุฑุงุก ููุท)
```

## ๐ ูุธุงู ุงูุตูุงุญูุงุช

### ุฃุฏูุงุฑ ุงููุณุชุฎุฏููู:

- **MANAGER**: ูุฏูุฑ ุนุงู - ุตูุงุญูุงุช ูุงููุฉ
- **BRANCH**: ููุธู ูุฑุน - ุตูุงุญูุงุช ูุญุฏูุฏุฉ ุจูุฑุนู

### ูููุฏ ุงูุตูุงุญูุงุช:

- **ููุธูู ุงููุฑูุน**: ูููููู ุฑุคูุฉ ูุชุนุฏูู ุดุญูุงุช ูุฑุนูู ููุท
- **ุงููุฏุฑุงุก**: ูููููู ุงููุตูู ูุฌููุน ุงูุจูุงูุงุช ูุฅุฏุงุฑุฉ ุงููุธุงู

## ๐๏ธ ุงูุฃูุงูุฑ ุงููููุฏุฉ

### ุงูุชุทููุฑ

```bash
yarn dev:full          # ุชุดุบูู ูุงูู (API + Frontend)
yarn api:dev           # ุชุดุบูู API Server ููุท
yarn dev               # ุชุดุบูู Frontend ููุท
```

### ูุงุนุฏุฉ ุงูุจูุงูุงุช

```bash
yarn db:studio         # ูุงุฌูุฉ ุฅุฏุงุฑุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช
yarn db:generate       # ุชูููุฏ ุนููู Prisma
yarn db:push           # ุชุทุจูู ุงูุชุบููุฑุงุช
yarn db:seed           # ุชุนุจุฆุฉ ุงูุจูุงูุงุช ุงูุฃูููุฉ
yarn db:reset          # ุฅุนุงุฏุฉ ุชุนููู ูุงุนุฏุฉ ุงูุจูุงูุงุช
```

### ุงูุฅูุชุงุฌ

```bash
yarn build             # ุจูุงุก Frontend ููุฅูุชุงุฌ
yarn api:build         # ุจูุงุก API Server ููุฅูุชุงุฌ
```

## ๐ฏ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

### ๐ Real-time Data

- ุชุญุฏูุซ ุงูุจูุงูุงุช ููุฑู ุจูู Frontend ูDatabase
- Cache ุฐูู ููุจูุงูุงุช ูุน ุฅููุงููุฉ ุงูุชุญุฏูุซ

### ๐ ุฃูุงู ูุญุณู

- JWT tokens ูุน ุงูุชูุงุก ุตูุงุญูุฉ
- ุชุณุฌูู ููุตู ูุฌููุน ุงูุนูููุงุช ูุน IP ูUser Agent
- ุชุดููุฑ ููู ููููุงุช ุงููุฑูุฑ

### ๐ APIs ูุชูุฏูุฉ

- Pagination ููุจูุงูุงุช ุงููุจูุฑุฉ
- Search ูุงูู filtering
- Error handling ุดุงูู
- Response standardization

### ๐ ุฃุฏุงุก ูุญุณู

- Database queries ูุญุณูุฉ
- Parallel API calls
- Loading states ููู UX ุฃูุถู

## ๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดุงูู ุดุงุฆุนุฉ:

#### ุฎุทุฃ: "Cannot connect to database"

```bash
# ุชุฃูุฏ ูู ุชุดุบูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
# ุชุญูู ูู DATABASE_URL ูู .env
```

#### ุฎุทุฃ: "API Server not responding"

```bash
# ุชุฃูุฏ ูู ุชุดุบูู API Server ุนูู ุงููููุฐ ุงูุตุญูุญ
yarn api:dev
```

#### ุฎุทุฃ: "Authentication failed"

```bash
# ุชุฃูุฏ ูู JWT_SECRET ูู .env
# ุงูุณุญ localStorage ูุณุฌู ุฏุฎูู ูุฌุฏุฏุงู
```

#### ุฎุทุฃ: "CORS issues"

```bash
# ุชุฃูุฏ ูู VITE_API_URL ูู .env
# ุชุฃูุฏ ูู ุชุทุงุจู ุงูููุงูุฐ
```

## ๐งช ุงุฎุชุจุงุฑ ุงููุธุงู

### 1. Health Check

```bash
curl http://localhost:5030/api/health
```

### 2. ุชุณุฌูู ุฏุฎูู

```bash
curl -X POST http://localhost:5030/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@fenertravel.com","password":"123456"}'
```

### 3. ุงูุญุตูู ุนูู ุงูุดุญูุงุช

```bash
curl -H "Authorization: Bearer YOUR_TOKEN" \
  http://localhost:5030/api/shipments
```

## ๐ ุงูุชูุซูู ุงูุฅุถุงูู

- [ุฏููู ูุงุนุฏุฉ ุงูุจูุงูุงุช](./README-DATABASE.md)
- [ุชุนูููุงุช ุงูุฅุนุฏุงุฏ](./SETUP-INSTRUCTIONS.md)

---

**ูุตูุญุฉ**: ุงุณุชุฎุฏู `yarn db:studio` ููุฑุงูุจุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฃุซูุงุก ุงูุชุทููุฑ!
